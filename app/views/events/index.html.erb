<% current_event_type = "" %>


<% content_for :sidebar do %>
  <%= render "sidebars/newsletter_signup" %>
<% end %>

<h1>Devil Dog Calendar:</h1>

<h2>Air Shows</h2>
<% if !@air_shows.blank? %>
<% @air_shows.each do |event| %>
<div class="calendar_row">
    <div class="date-graphic">
    <% if event.start.strftime("%b %d" ) == event.end.strftime("%b %d") %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <% else %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <span style="float: left; font-size: 1em;margin: 0.5em 0 0 0;">&#8211; </span>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.end.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.end.strftime("%d") %></div>
    </div>
    <% end %>
  </div>
  <div class="event-info">
    <%= link_to event.title, event %>
      <% if event.event_statuses_id == 2 %>
        <span class="error" style="display: inline;"> -- Tentative</span>
      <% elsif event.event_statuses_id == 3 %>
        <span class="error" style="display: inline;"> -- Canceled</span>
      <% end %>
      <br />
      <% if event.details.length > 100 %>
        <p class="event-details"><%= truncate(event.details, :length => 100, :separator => ' ') %> <em><%= link_to "Go to event", event %></em></p>
      <% else %>
        <p class="event-details"><%= event.details %></p>
      <% end %>
  </div>
</div>
<% current_event_type = event.event_type.title %>
<% end %>
<% else %>
   <div class="calendar_row">
     <p>No scheduled air shows at this time.</p>
  </div>
<% end %>


<h2>Special Events</h2>
<% if !@special.blank? %>
<% @special.each do |event| %>
<div class="calendar_row">
    <div class="date-graphic">
    <% if event.start.strftime("%b %d" ) == event.end.strftime("%b %d") %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <% else %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <span style="float: left; font-size: 1em;margin: 0.5em 0 0 0;">&#8211; </span>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.end.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.end.strftime("%d") %></div>
    </div>
    <% end %>
  </div>
  <div class="event-info">
    <%= link_to event.title, event %>
      <% if event.event_statuses_id == 2 %>
        <span class="error" style="display: inline;"> -- Tentative</span>
      <% elsif event.event_statuses_id == 3 %>
        <span class="error" style="display: inline;"> -- Canceled</span>
      <% end %>
      <br />
      <% if event.details.length > 100 %>
        <p class="event-details"><%= truncate(event.details, :length => 100, :separator => ' ') %> <em><%= link_to "Go to event", event %></em></p>
      <% else %>
        <p class="event-details"><%= event.details %></p>
      <% end %>
  </div>
</div>
<% current_event_type = event.event_type.title %>
<% end %>
<% else %>
   <div class="calendar_row">
     <p>No scheduled special events at this time.</p>
  </div>
<% end %>

<h2>Squadron Meetings</h2>
<% if !@meetings.blank? %>
<% @meetings.each do |event| %>
<div class="calendar_row">
    <div class="date-graphic">
    <% if event.start.strftime("%b %d" ) == event.end.strftime("%b %d") %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <% else %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <span style="float: left; font-size: 1em;margin: 0.5em 0 0 0;">&#8211; </span>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.end.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.end.strftime("%d") %></div>
    </div>
    <% end %>
  </div>
  <div class="event-info">
    <%= link_to event.title, event %>
      <% if event.event_statuses_id == 2 %>
        <span class="error" style="display: inline;"> -- Tentative</span>
      <% elsif event.event_statuses_id == 3 %>
        <span class="error" style="display: inline;"> -- Canceled</span>
      <% end %>
      <br />
      <% if event.details.length > 100 %>
        <p class="event-details"><%= truncate(event.details, :length => 100, :separator => ' ') %> <em><%= link_to "Go to event", event %></em></p>
      <% else %>
        <p class="event-details"><%= event.details %></p>
      <% end %>
  </div>
</div>
<% current_event_type = event.event_type.title %>
<% end %>
<% else %>
   <div class="calendar_row">
     <p>No scheduled squadron meetings at this time.</p>
  </div>
<% end %>

<h2>Maintenance</h2>
<% if !@maint.blank? %>
<% @maint.each do |event| %>
<div class="calendar_row">
    <div class="date-graphic">
    <% if event.start.strftime("%b %d" ) == event.end.strftime("%b %d") %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <% else %>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.start.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.start.strftime("%d") %></div>
    </div>
    <span style="float: left; font-size: 1em;margin: 0.5em 0 0 0;">&#8211; </span>
    <div class="calendar-ii">
      <div class="calendar_month-ii"><%= event.end.strftime("%b") %></div>
      <div class="calendar_date-ii"><%= event.end.strftime("%d") %></div>
    </div>
    <% end %>
  </div>
  <div class="event-info">
    <%= link_to event.title, event %>
      <% if event.event_statuses_id == 2 %>
        <span class="error" style="display: inline;"> -- Tentative</span>
      <% elsif event.event_statuses_id == 3 %>
        <span class="error" style="display: inline;"> -- Canceled</span>
      <% end %>
      <br />
      <% if event.details.length > 100 %>
        <p class="event-details"><%= truncate(event.details, :length => 100, :separator => ' ') %> <em><%= link_to "Go to event", event %></em></p>
      <% else %>
        <p class="event-details"><%= event.details %></p>
      <% end %>
  </div>
</div>
<% current_event_type = event.event_type.title %>
<% end %>
<% else %>
   <div class="calendar_row">
     <p>No scheduled maintenance at this time.</p>
  </div>
<% end %>

<br />

<% if signed_in?%>
    <% if current_user.roles.any? {|role| role.name == "superuser" or role.name == "admin" } %>
       <%= link_to 'New Event', new_event_path %> | <%= link_to 'Past Events', all_events_path %>
    <% end %>
<% end %>


